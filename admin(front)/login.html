<!DOCTYPE html>
<html lang="en">
	<head>
		<title>Sign In</title>

		<meta charset="utf-8">
		<meta name="viewport" content="width=device-width, initial-scale=1">
		<link rel="stylesheet" type="text/css" href="css/bootstrap.min.css">
	

		<link rel="stylesheet" type="text/css" href="css/login.css">
	</head>
	<body>

		<div class="bg"></div>

		<div class="container">
			<form id="login_form">
				<div class="form-group">
					<input type="text" class="form-control" id="username" name="username" placeholder="Enter Username">

					<br>

					<input type="password" class="form-control" id="password" name="password" placeholder="Enter Password">

					<br>

					<button type="button" class="btn btn-primary btn-block" id="btn-login"> Login </button>
					<button type="button" class="btn btn-primary btn-block" onclick="window.location.href='register.html'">Register</button>
				</div>
			</form>
		</div>
		<script type="text/javascript">              

		/*	function login(){
			    var username = $("#username").val();
			    var password = $("#password").val();
			       $.ajax({
			           async: true, 
			           url: "https://mighty-cove-44634.herokuapp.com/login",
			           contentType: 'application/json; charset=utf-8',
			           data: JSON.stringify({
			               'username': username,
			               'password': password
			           }),
			           type: "POST",
			           dataType: "json",
			           crossDomain: true,
			           headers: {
			               'Authorization' : 'Basic ' + btoa(username + ':' + password)
			           },

			        error: function (data) {
			          	console.log(data)
			        },

			        success: function (data)  {
				           alert(username+ " logged innnnnnnn")
				           localStorage.setItem('token', data.token);
				           localStorage.setItem('username', username);
				           window.location.assign('pages/attendance.html');
			        },
			    });
			}	*/


		$('document').ready(function(){ 
		     /* validation */
		  	$("#login-form").validate({
			  	rules:{
			   		password: {
			   			required: true,
			   		},
			   		username: {
			            required: true,
			            email: true
			        },
			    },
			    messages:{
			        password:{
			             required: "please enter your password"
			        },
			        username: "please enter your email address",
			       },
			    submitHandler: submitForm 
		    });  
		    /* validation */
		    
		    /* login submit */
		    function submitForm(){  
		   		var data = $("#login-form").serialize();
		    
		   		$.ajax({		    
				   type : 'POST',
				   url  : "https://mighty-cove-44634.herokuapp.com/login",
				   data : data,
				   beforeSend: function()
				   { 
				    $("#error").fadeOut();
				    $("#btn-login").html('<span class="glyphicon glyphicon-transfer"></span> &nbsp; sending ...');
				   },
				   success :  function(response)
				      {      
				     if(response=="ok"){
				         
				      $("#btn-login").html('<img src="btn-ajax-loader.gif" /> &nbsp; Signing In ...');
				      setTimeout(' window.location.href = "pages/attendance.html"; ',4000);
				     }
				     else{
				         
				      $("#error").fadeIn(1000, function(){      
				    $("#error").html('<div class="alert alert-danger"> <span class="glyphicon glyphicon-info-sign"></span> &nbsp; '+response+' !</div>');
				           $("#btn-login").html('<span class="glyphicon glyphicon-log-in"></span> &nbsp; Sign In');
				         });
				     }
				     }
			   	});
		    return false;
		  }
		    /* login submit */
		});

		</script>

    <!-- jQuery -->
    <script src="vendor/jquery/jquery.min.js"></script>
    <script src="vendor/jquery/jquery.js"></script>
    <script type="text/javascript" src="vendor/bootstrap/js/bootstrap.js"></script>
	<script type="text/javascript" src="vendor/bootstrap/js/bootstrap.min.js"></script>

	</body>
</html>